<script src="https://cdn.tailwindcss.com"></script>
<script>
    // C·∫§U H√åNH MATHJAX: ƒê·∫£m b·∫£o MathJax x·ª≠ l√Ω ƒë√∫ng c√°c c√¥ng th·ª©c LaTeX
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        },
        svg: {
            fontCache: 'global'
        },
        startup: {
            // T·∫Øt render t·ª± ƒë·ªông khi kh·ªüi ƒë·ªông ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ g·ªçi th·ªß c√¥ng sau khi t·∫£i n·ªôi dung
            ready: () => {
                MathJax.startup.defaultReady();
                // B·∫Øt ƒë·∫ßu tr√≤ ch∆°i sau khi MathJax ƒë√£ s·∫µn s√†ng
                if (document.readyState === 'complete') {
                    startInitialSetup();
                } else {
                    window.addEventListener('load', startInitialSetup);
                }
            }
        }
    };
    
    // H√†m ƒë·ªÉ chuy·ªÉn ƒë·ªïi PCM 16-bit sang WAV v√† ph√°t √¢m thanh
    function base64ToArrayBuffer(base64) {
        const binaryString = atob(base64);
        const len = binaryString.length;
        const bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binaryString.charCodeAt(i);
        }
        return bytes.buffer;
    }

    function pcmToWav(pcm16, sampleRate = 24000) {
        const numChannels = 1;
        const bitsPerSample = 16;
        const byteRate = numChannels * sampleRate * (bitsPerSample / 8);
        const blockAlign = numChannels * (bitsPerSample / 8);

        const buffer = new ArrayBuffer(44 + pcm16.length * 2);
        const view = new DataView(buffer);
        let offset = 0;

        function writeString(s) {
            for (let i = 0; i < s.length; i++) {
                view.setUint8(offset + i, s.charCodeAt(i));
            }
            offset += s.length;
        }

        function writeUint32(i) {
            view.setUint32(offset, i, true);
            offset += 4;
        }

        function writeUint16(i) {
            view.setUint16(offset, i, true);
            offset += 2;
        }

        // RIFF chunk
        writeString('RIFF');
        writeUint32(36 + pcm16.length * 2);
        writeString('WAVE');

        // FMT sub-chunk
        writeString('fmt ');
        writeUint32(16); // Sub-chunk size
        writeUint16(1); // Audio format (1 for PCM)
        writeUint16(numChannels);
        writeUint32(sampleRate);
        writeUint32(byteRate);
        writeUint16(blockAlign);
        writeUint16(bitsPerSample);

        // DATA sub-chunk
        writeString('data');
        writeUint32(pcm16.length * 2);

        // Write PCM data
        for (let i = 0; i < pcm16.length; i++) {
            view.setInt16(offset, pcm16[i], true);
            offset += 2;
        }

        return new Blob([view], { type: 'audio/wav' });
    }

    // --- Audio Generation Logic ---
    const AUDIO_CACHE = {};
    const AUDIO_VOICES = {
        correct: { text: "Tuy·ªát v·ªùi!", voiceName: "Kore" },
        wrong: { text: "Sai r·ªìi.", voiceName: "Fenrir" }
    };

    async function generateAndPlayAudio(type) {
        const { text, voiceName } = AUDIO_VOICES[type];
        if (AUDIO_CACHE[type]) {
            playAudio(AUDIO_CACHE[type]);
            return;
        }

        const apiKey = "";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;

        const payload = {
            contents: [{ parts: [{ text: text }] }],
            generationConfig: {
                responseModalities: ["AUDIO"],
                speechConfig: {
                    voiceConfig: { prebuiltVoiceConfig: { voiceName: voiceName } }
                }
            },
            model: "gemini-2.5-flash-preview-tts"
        };

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const result = await response.json();
            const part = result?.candidates?.[0]?.content?.parts?.[0];
            const audioData = part?.inlineData?.data;
            const mimeType = part?.inlineData?.mimeType;

            if (audioData && mimeType && mimeType.startsWith("audio/")) {
                // Assuming sample rate of 24000 for simplicity as it's the default
                const sampleRate = 24000;
                const pcmData = base64ToArrayBuffer(audioData);
                const pcm16 = new Int16Array(pcmData);
                const wavBlob = pcmToWav(pcm16, sampleRate);
                const audioUrl = URL.createObjectURL(wavBlob);
                AUDIO_CACHE[type] = audioUrl;
                playAudio(audioUrl);
            }
        } catch (error) {
            console.error("L·ªói t·∫°o ho·∫∑c ph√°t √¢m thanh:", error);
        }
    }

    function playAudio(url) {
        const audio = new Audio(url);
        audio.play().catch(e => console.error("L·ªói ph√°t Audio:", e));
    }

    // --- Quiz Data ---
    const QUIZ_QUESTIONS = [
        // --------------------------------------------------------------------------------
        // CH∆Ø∆†NG 1: S·ªê T·ª∞ NHI√äN (10 c√¢u)
        // --------------------------------------------------------------------------------
        {
            id: 1,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "T·∫≠p h·ª£p $A = \\{x \\in \\mathbb{N} | 18 < x < 21\\}$ c√≥ bao nhi√™u ph·∫ßn t·ª≠?",
            options: [
                { text: "1", correct: false, rationale: "T·∫≠p h·ª£p A ch·ª©a c√°c s·ªë $\\{19, 20\\}$." },
                { text: "2", correct: true, rationale: "T·∫≠p h·ª£p A ch·ªâ ch·ª©a c√°c s·ªë t·ª± nhi√™n $\\{19, 20\\}$, do ƒë√≥ c√≥ 2 ph·∫ßn t·ª≠." },
                { text: "3", correct: false, rationale: "C·∫ßn li·ªát k√™ ch√≠nh x√°c c√°c s·ªë t·ª± nhi√™n l·ªõn h∆°n 18 v√† nh·ªè h∆°n 21." },
                { text: "V√¥ s·ªë", correct: false, rationale: "ƒê√¢y l√† t·∫≠p h·ª£p h·ªØu h·∫°n, kh√¥ng ph·∫£i v√¥ s·ªë." }
            ],
            answer: "2",
            hint: "H√£y li·ªát k√™ c√°c s·ªë t·ª± nhi√™n l·ªõn h∆°n 18 v√† nh·ªè h∆°n 21."
        },
        {
            id: 2,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Gi√° tr·ªã c·ªßa bi·ªÉu th·ª©c $84:4 + 3^9:3^7 + 5^0$ l√† bao nhi√™u?",
            options: [
                { text: "30", correct: false, rationale: "T√≠nh to√°n l·∫°i ph√©p l≈©y th·ª´a v√† th·ª© t·ª± ∆∞u ti√™n." },
                { text: "31", correct: true, rationale: "Th·ª±c hi·ªán ph√©p t√≠nh: $21 + 3^2 + 1 = 21 + 9 + 1 = 31$." },
                { text: "32", correct: false, rationale: "Nh·ªõ r·∫±ng b·∫•t k·ª≥ s·ªë n√†o m≈© 0 c≈©ng b·∫±ng 1." },
                { text: "29", correct: false, rationale: "C·∫ßn √°p d·ª•ng ƒë√∫ng th·ª© t·ª± th·ª±c hi·ªán ph√©p t√≠nh." }
            ],
            answer: "31",
            hint: "Quy t·∫Øc l≈©y th·ª´a: $a^m : a^n = a^{m-n}$ v√† $a^0 = 1$."
        },
        {
            id: 3,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "S·ªë n√†o trong c√°c s·ªë sau ƒë√¢y chia h·∫øt cho c·∫£ 3 v√† 5: 4827; 5670; 6915; 2007?",
            options: [
                { text: "4827", correct: false, rationale: "S·ªë n√†y kh√¥ng chia h·∫øt cho 5." },
                { text: "5670", correct: true, rationale: "T·∫≠n c√πng l√† 0 (chia h·∫øt cho 5), t·ªïng c√°c ch·ªØ s·ªë l√† $18$ (chia h·∫øt cho 3)." },
                { text: "6915", correct: false, rationale: "S·ªë n√†y chia h·∫øt cho 5, nh∆∞ng t·ªïng c√°c ch·ªØ s·ªë l√† $21$ (chia h·∫øt cho 3)." },
                { text: "2007", correct: false, rationale: "S·ªë n√†y kh√¥ng chia h·∫øt cho 5." }
            ],
            answer: "5670",
            hint: "M·ªôt s·ªë chia h·∫øt cho 5 khi t·∫≠n c√πng l√† 0 ho·∫∑c 5. Chia h·∫øt cho 3 khi t·ªïng c√°c ch·ªØ s·ªë chia h·∫øt cho 3."
        },
        {
            id: 4,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "S·ªë t·ª± nhi√™n $x$ l·ªõn nh·∫•t th·ªèa m√£n $24 \\vdots x$, $36 \\vdots x$, v√† $160 \\vdots x$ l√† bao nhi√™u?",
            options: [
                { text: "8", correct: false, rationale: "S·ªë 8 kh√¥ng l√† ∆∞·ªõc c·ªßa 36." },
                { text: "12", correct: false, rationale: "12 kh√¥ng l√† ∆∞·ªõc c·ªßa 160." },
                { text: "4", correct: true, rationale: "∆ØCLN c·ªßa $24, 36, 160$ l√† $4$." },
                { text: "2", correct: false, rationale: "C√≥ ∆∞·ªõc chung l·ªõn h∆°n l√† $4$." }
            ],
            answer: "4",
            hint: "B·∫°n c·∫ßn t√¨m ∆ØCLN (∆Ø·ªõc chung l·ªõn nh·∫•t) c·ªßa $24, 36$ v√† $160$."
        },
        {
            id: 5,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Th·ª±c hi·ªán ph√©p t√≠nh nhanh: $12 \\cdot 35 + 35 \\cdot 182 - 35 \\cdot 94$.",
            options: [
                { text: "3500", correct: true, rationale: "√Åp d·ª•ng t√≠nh ch·∫•t ph√¢n ph·ªëi: $35 \\cdot (12 + 182 - 94) = 35 \\cdot 100 = 3500$." },
                { text: "350", correct: false, rationale: "K·∫øt qu·∫£ ƒë√∫ng l√† $3500$." },
                { text: "3000", correct: false, rationale: "T√≠nh to√°n l·∫°i t·ªïng hi·ªáu trong ngo·∫∑c." },
                { text: "3150", correct: false, rationale: "K·∫øt qu·∫£ t√≠nh sai." }
            ],
            answer: "3500",
            hint: "S·ª≠ d·ª•ng t√≠nh ch·∫•t ph√¢n ph·ªëi $a \\cdot b + a \\cdot c - a \\cdot d = a \\cdot (b + c - d)$."
        },
        {
            id: 6,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "T√≠nh gi√° tr·ªã c·ªßa bi·ªÉu th·ª©c $295-(31-2^{2} \\cdot 5)^{2}$.",
            answer: "174", // ƒê√É S·ª¨A: 295 - (31 - 20)^2 = 295 - 11^2 = 295 - 121 = 174
            hint: "∆Øu ti√™n t√≠nh l≈©y th·ª´a, ph√©p nh√¢n, ph√©p tr·ª´ trong ngo·∫∑c tr∆∞·ªõc. K·∫øt qu·∫£ trong ngo·∫∑c l√† 11."
        },
        {
            id: 7,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "T√¨m s·ªë t·ª± nhi√™n $x$ bi·∫øt $87-(73-x)=20$.",
            answer: "6",
            hint: "T√¨m gi√° tr·ªã c·ªßa $(73-x)$ tr∆∞·ªõc, sau ƒë√≥ t√¨m $x$."
        },
        {
            id: 8,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "S·ªë t·ª± nhi√™n $x$ nh·ªè nh·∫•t kh√°c $0$ th·ªèa m√£n $x \\vdots 4$, $x \\vdots 7$, $x \\vdots 8$ l√† bao nhi√™u?",
            options: [
                { text: "28", correct: false, rationale: "28 kh√¥ng chia h·∫øt cho 8." },
                { text: "56", correct: true, rationale: "ƒê√¢y l√† BCNN c·ªßa $4, 7, 8$, c√≥ gi√° tr·ªã l√† $56$." },
                { text: "168", correct: false, rationale: "L√† m·ªôt b·ªôi chung, nh∆∞ng kh√¥ng ph·∫£i nh·ªè nh·∫•t kh√°c $0$." },
                { text: "4", correct: false, rationale: "4 kh√¥ng chia h·∫øt cho 7 v√† 8." }
            ],
            answer: "56",
            hint: "B·∫°n c·∫ßn t√¨m BCNN (B·ªôi chung nh·ªè nh·∫•t) c·ªßa $4, 7$ v√† $8$."
        },
        {
            id: 9,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "M·ªôt l·ªõp h·ªçc c√≥ 24 nam v√† 18 n·ªØ. H·ªèi c√≥ th·ªÉ chia l·ªõp th√†nh nhi·ªÅu nh·∫•t bao nhi√™u nh√≥m m√† s·ªë nam v√† s·ªë n·ªØ ƒë∆∞·ª£c chia ƒë·ªÅu v√†o m·ªói nh√≥m?",
            answer: "6",
            hint: "C·∫ßn t√¨m ∆ØCLN c·ªßa $24$ v√† $18$."
        },
        {
            id: 10,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "T√¨m $x$ bi·∫øt $4^{x}=64$.",
            options: [
                { text: "2", correct: false, rationale: "$4^2 = 16$." },
                { text: "3", correct: true, rationale: "$4^3 = 64$." },
                { text: "4", correct: false, rationale: "$4^4 = 256$." },
                { text: "16", correct: false, rationale: "ƒê√¢y l√† c∆° s·ªë ch·ª© kh√¥ng ph·∫£i s·ªë m≈©." }
            ],
            answer: "3",
            hint: "H√£y vi·∫øt $64$ d∆∞·ªõi d·∫°ng l≈©y th·ª´a c·ªßa $4$."
        },

        // --------------------------------------------------------------------------------
        // CH∆Ø∆†NG 2: S·ªê NGUY√äN (10 c√¢u)
        // --------------------------------------------------------------------------------
        {
            id: 11,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "S·ªë ƒë·ªëi c·ªßa s·ªë nguy√™n $-100$ l√† s·ªë n√†o?",
            options: [
                { text: "$100$", correct: true, rationale: "S·ªë ƒë·ªëi c·ªßa m·ªôt s·ªë nguy√™n $a$ l√† s·ªë $-a$." },
                { text: "$-100$", correct: false, rationale: "S·ªë ƒë·ªëi kh√¥ng ph·∫£i l√† ch√≠nh n√≥." },
                { text: "$0$", correct: false, rationale: "S·ªë ƒë·ªëi c·ªßa $0$ l√† $0$." },
                { text: "$1/100$", correct: false, rationale: "ƒê√¢y l√† ngh·ªãch ƒë·∫£o, kh√¥ng ph·∫£i s·ªë ƒë·ªëi." }
            ],
            answer: "100",
            hint: "S·ªë ƒë·ªëi c·ªßa $a$ l√† $-a$, v√† s·ªë ƒë·ªëi c·ªßa $-a$ l√† $a$."
        },
        {
            id: 12,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "So s√°nh hai s·ªë nguy√™n $-28$ v√† $-56$. K·∫øt qu·∫£ n√†o ƒë√∫ng?",
            options: [
                { text: "$-28 < -56$", correct: false, rationale: "S·ªë nguy√™n √¢m c√≥ gi√° tr·ªã tuy·ªát ƒë·ªëi nh·ªè h∆°n th√¨ l·ªõn h∆°n." },
                { text: "$-28 > -56$", correct: true, rationale: "Tr√™n tr·ª•c s·ªë, $-28$ n·∫±m b√™n ph·∫£i $-56$ n√™n l·ªõn h∆°n." },
                { text: "$-28 = -56$", correct: false, rationale: "Hai s·ªë n√†y c√≥ gi√° tr·ªã kh√°c nhau." },
                { text: "Kh√¥ng so s√°nh ƒë∆∞·ª£c", correct: false, rationale: "Ho√†n to√†n c√≥ th·ªÉ so s√°nh ƒë∆∞·ª£c hai s·ªë nguy√™n." }
            ],
            answer: "$-28 > -56$",
            hint: "S·ªë nguy√™n √¢m c√†ng g·∫ßn $0$ th√¨ c√†ng l·ªõn."
        },
        {
            id: 13,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "T√≠nh t·ªïng: $(-40) + (-25)$.",
            answer: "-65",
            hint: "C·ªông hai s·ªë nguy√™n √¢m ta c·ªông c√°c gi√° tr·ªã tuy·ªát ƒë·ªëi v√† ƒë·∫∑t d·∫•u √¢m."
        },
        {
            id: 14,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "K·∫øt qu·∫£ c·ªßa ph√©p t√≠nh $(-8) \\cdot (-15)$ l√† bao nhi√™u?",
            options: [
                { text: "$-120$", correct: false, rationale: "T√≠ch c·ªßa hai s·ªë √¢m l√† m·ªôt s·ªë d∆∞∆°ng." },
                { text: "$120$", correct: true, rationale: "T√≠ch c·ªßa hai s·ªë nguy√™n √¢m l√† m·ªôt s·ªë nguy√™n d∆∞∆°ng." },
                { text: "$-23$", correct: false, rationale: "ƒê√¢y l√† ph√©p nh√¢n, kh√¥ng ph·∫£i ph√©p c·ªông." },
                { text: "$7$", correct: false, rationale: "ƒê√¢y l√† ph√©p nh√¢n, kh√¥ng ph·∫£i ph√©p c·ªông." }
            ],
            answer: "120",
            hint: "Nh√¢n hai s·ªë c√πng d·∫•u s·∫Ω cho ra k·∫øt qu·∫£ d∆∞∆°ng."
        },
        {
            id: 15,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "S·∫Øp x·∫øp c√°c s·ªë nguy√™n sau theo th·ª© t·ª± tƒÉng d·∫ßn: $5; -7; 4; -12; 0; -3; -5; 1$. Th·ª© t·ª± ƒë√∫ng l√†:",
            options: [
                { text: "$-7; -12; -5; -3; 0; 1; 4; 5$", correct: false, rationale: "Ki·ªÉm tra l·∫°i th·ª© t·ª± c·ªßa $-7$ v√† $-12$." },
                { text: "$5; 4; 1; 0; -3; -5; -7; -12$", correct: false, rationale: "ƒê√¢y l√† th·ª© t·ª± gi·∫£m d·∫ßn." },
                { text: "$-12; -7; -5; -3; 0; 1; 4; 5$", correct: true, rationale: "S·ªë √¢m nh·ªè nh·∫•t l√† $-12$, sau ƒë√≥ tƒÉng d·∫ßn ƒë·∫øn s·ªë d∆∞∆°ng l·ªõn nh·∫•t l√† $5$." },
                { text: "$-12; -7; -5; 0; -3; 1; 4; 5$", correct: false, rationale: "Ki·ªÉm tra l·∫°i v·ªã tr√≠ c·ªßa $-3$ v√† $0$." }
            ],
            answer: "$-12; -7; -5; -3; 0; 1; 4; 5$",
            hint: "H√£y b·∫Øt ƒë·∫ßu b·∫±ng s·ªë nguy√™n √¢m c√≥ gi√° tr·ªã tuy·ªát ƒë·ªëi l·ªõn nh·∫•t."
        },
        {
            id: 16,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "T√¨m s·ªë nguy√™n $x$ bi·∫øt $x^2 = 100$. (Ch·ªâ nh·∫≠p s·ªë nguy√™n d∆∞∆°ng).",
            answer: "10",
            hint: "M·ªôt s·ªë $x$ b√¨nh ph∆∞∆°ng b·∫±ng $100$, $x$ c√≥ th·ªÉ l√† s·ªë d∆∞∆°ng ho·∫∑c s·ªë √¢m."
        },
        {
            id: '17',
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Gi√° tr·ªã c·ªßa bi·ªÉu th·ª©c $(-524) - [(476 + 245) - 45]$ l√† bao nhi√™u?",
            options: [
                { text: "$-1200$", correct: true, rationale: "√Åp d·ª•ng t√≠nh h·ª£p l√Ω: $(-524 - 476) + (-245 + 45) = -1000 + (-200) = -1200$." },
                { text: "$-120$", correct: false, rationale: "K·∫øt qu·∫£ ƒë√∫ng ph·∫£i l√† $-1200$." },
                { text: "$-1450$", correct: false, rationale: "T√≠nh to√°n l·∫°i." },
                { text: "$-1000$", correct: false, rationale: "C√≤n thi·∫øu m·ªôt ph·∫ßn c·ªßa ph√©p t√≠nh." }
            ],
            answer: "$-1200$",
            hint: "S·ª≠ d·ª•ng quy t·∫Øc b·ªè d·∫•u ngo·∫∑c v√† nh√≥m c√°c s·ªë tr√≤n ngh√¨n ho·∫∑c tr√≤n trƒÉm."
        },
        {
            id: 18,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "Nhi·ªát ƒë·ªô bu·ªïi s√°ng l√† $-4^{\\circ}C$, bu·ªïi tr∆∞a tƒÉng $7^{\\circ}C$. H·ªèi nhi·ªát ƒë·ªô bu·ªïi tr∆∞a l√† bao nhi√™u ƒë·ªô $\\text{C}$?",
            answer: "3",
            hint: "Th·ª±c hi·ªán ph√©p c·ªông s·ªë nguy√™n: $-4 + 7$."
        },
        {
            id: 19,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Hi·ªáu ƒë·ªô cao gi·ªØa ƒë·ªânh n√∫i $1500 \\text{ m}$ v√† ƒë√°y hang $-200 \\text{ m}$ l√† bao nhi√™u m√©t?",
            options: [
                { text: "$1300 \\text{ m}$", correct: false, rationale: "ƒê√¢y l√† ph√©p tr·ª´: $1500 - 200$." },
                { text: "$1700 \\text{ m}$", correct: true, rationale: "Hi·ªáu ƒë·ªô cao l√† $1500 - (-200) = 1700$ m√©t." },
                { text: "$200 \\text{ m}$", correct: false, rationale: "ƒê√¢y l√† ƒë·ªô s√¢u c·ªßa hang." },
                { text: "$1000 \\text{ m}$", correct: false, rationale: "T√≠nh to√°n l·∫°i." }
            ],
            answer: "$1700 \\text{ m}$",
            hint: "ƒê·ªÉ t√≠nh ch√™nh l·ªách, b·∫°n c·∫ßn l·∫•y ƒë·ªô cao l·ªõn h∆°n tr·ª´ ƒëi ƒë·ªô cao nh·ªè h∆°n."
        },
        {
            id: 20,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "ƒê√¢u l√† k·∫øt qu·∫£ ƒë√∫ng c·ªßa ph√©p t√≠nh: $36 - 38$?",
            options: [
                { text: "$2$", correct: false, rationale: "Ph√©p t√≠nh n√†y l√† ph√©p tr·ª´ s·ªë nguy√™n." },
                { text: "$-2$", correct: true, rationale: "Th·ª±c hi·ªán ph√©p tr·ª´: $36 - 38 = -(38 - 36) = -2$." },
                { text: "$74$", correct: false, rationale: "ƒê√¢y l√† ph√©p c·ªông kh√¥ng ƒë√∫ng." },
                { text: "$-74$", correct: false, rationale: "ƒê√¢y l√† ph√©p c·ªông kh√¥ng ƒë√∫ng." }
            ],
            answer: "-2",
            hint: "B·∫°n ƒëang tr·ª´ m·ªôt s·ªë l·ªõn h∆°n cho m·ªôt s·ªë nh·ªè h∆°n."
        },

        // --------------------------------------------------------------------------------
        // CH∆Ø∆†NG 3: C√ÅC H√åNH PH·∫≤NG (20 c√¢u)
        // --------------------------------------------------------------------------------
        {
            id: 21,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Di·ªán t√≠ch h√¨nh b√¨nh h√†nh c√≥ ƒë·ªô d√†i m·ªôt c·∫°nh $15 \\text{cm}$ v√† chi·ªÅu cao t∆∞∆°ng ·ª©ng $6 \\text{cm}$ l√† bao nhi√™u?",
            options: [
                { text: "$21 \\text{ cm}^2$", correct: false, rationale: "Di·ªán t√≠ch h√¨nh b√¨nh h√†nh b·∫±ng c·∫°nh ƒë√°y nh√¢n chi·ªÅu cao t∆∞∆°ng ·ª©ng." },
                { text: "$45 \\text{ cm}^2$", correct: false, rationale: "Di·ªán t√≠ch l√† $15 \\cdot 6$." },
                { text: "$90 \\text{ cm}^2$", correct: true, rationale: "Di·ªán t√≠ch $= 15 \\cdot 6 = 90 \\text{ cm}^2$." },
                { text: "$180 \\text{ cm}^2$", correct: false, rationale: "T√≠nh to√°n l·∫°i." }
            ],
            answer: "$90 \\text{ cm}^2$",
            hint: "C√¥ng th·ª©c di·ªán t√≠ch h√¨nh b√¨nh h√†nh: $S = a \\cdot h$."
        },
        {
            id: 22,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Di·ªán t√≠ch h√¨nh thoi c√≥ ƒë·ªô d√†i hai ƒë∆∞·ªùng ch√©o l√† $4 \\text{m}$ v√† $25 \\text{dm}$ l√† bao nhi√™u $\\text{m}^2$?",
            options: [
                { text: "$50 \\text{ m}^2$", correct: false, rationale: "C·∫ßn ƒë·ªïi ƒë∆°n v·ªã $25 \\text{ dm} = 2.5 \\text{ m}$." },
                { text: "$5 \\text{ m}^2$", correct: true, rationale: "ƒê·ªïi ƒë∆°n v·ªã: $25 \\text{ dm} = 2.5 \\text{ m}$. Di·ªán t√≠ch $= \\frac{1}{2} \\cdot 4 \\cdot 2.5 = 5 \\text{ m}^2$." },
                { text: "$2.5 \\text{ m}^2$", correct: false, rationale: "Di·ªán t√≠ch b·∫±ng n·ª≠a t√≠ch hai ƒë∆∞·ªùng ch√©o." },
                { text: "$10 \\text{ m}^2$", correct: false, rationale: "Ch∆∞a nh√¢n v·ªõi $\\frac{1}{2}$." }
            ],
            answer: "$5 \\text{ m}^2$",
            hint: "ƒê·∫ßu ti√™n, h√£y ƒë·ªïi $25 \\text{ dm}$ ra ƒë∆°n v·ªã m√©t."
        },
        {
            id: 23,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "H√¨nh ch·ªØ nh·∫≠t c√≥ chi·ªÅu d√†i $12 \\text{cm}$ v√† chi·ªÅu r·ªông $8 \\text{ cm}$. T√≠nh chu vi h√¨nh ch·ªØ nh·∫≠t ƒë√≥ (ƒë∆°n v·ªã $\\text{cm}$).",
            answer: "40",
            hint: "C√¥ng th·ª©c chu vi h√¨nh ch·ªØ nh·∫≠t: $P = 2 \\cdot (a+b)$."
        },
        {
            id: 24,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Di·ªán t√≠ch h√¨nh thang c√¢n c√≥ ƒë·ªô d√†i hai c·∫°nh ƒë√°y l√† $7 \\text{m}$ v√† $4 \\text{m}$; chi·ªÅu cao l√† $3,5 \\text{m}$ l√† bao nhi√™u $\\text{m}^2$?",
            options: [
                { text: "$12.25 \\text{ m}^2$", correct: false, rationale: "√Åp d·ª•ng c√¥ng th·ª©c $S = \\frac{(7+4) \\cdot 3.5}{2}$." },
                { text: "$19.25 \\text{ m}^2$", correct: true, rationale: "Di·ªán t√≠ch $= \\frac{(7+4) \\cdot 3.5}{2} = 19.25 \\text{ m}^2$." },
                { text: "$22 \\text{ m}^2$", correct: false, rationale: "B·∫°n c√≥ th·ªÉ ƒë√£ nh√¢n m√† ch∆∞a chia $2$." },
                { text: "$15.5 \\text{ m}^2$", correct: false, rationale: "T√≠nh to√°n l·∫°i." }
            ],
            answer: "$19.25 \\text{ m}^2$",
            hint: "C√¥ng th·ª©c di·ªán t√≠ch h√¨nh thang: $S = \\frac{(a+b) \\cdot h}{2}$."
        },
        {
            id: 25,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "H√¨nh vu√¥ng c√≥ c·∫°nh $6 \\text{ cm}$. Di·ªán t√≠ch c·ªßa n√≥ l√† bao nhi√™u $\\text{cm}^2$?",
            options: [
                { text: "$24 \\text{ cm}^2$", correct: false, rationale: "ƒê√¢y l√† chu vi." },
                { text: "$12 \\text{ cm}^2$", correct: false, rationale: "ƒê√∫ng l√† ph√©p nh√¢n $6 \\cdot 6$." },
                { text: "$36 \\text{ cm}^2$", correct: true, rationale: "Di·ªán t√≠ch $= 6^2 = 36 \\text{ cm}^2$." },
                { text: "$6 \\text{ cm}^2$", correct: false, rationale: "Sai c√¥ng th·ª©c." }
            ],
            answer: "$36 \\text{ cm}^2$",
            hint: "Di·ªán t√≠ch h√¨nh vu√¥ng b·∫±ng b√¨nh ph∆∞∆°ng c·∫°nh."
        },
        {
            id: 26,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "Chu vi h√¨nh thoi c√≥ c·∫°nh $5 \\text{cm}$ l√† bao nhi√™u $\\text{cm}$?",
            answer: "20",
            hint: "H√¨nh thoi c√≥ 4 c·∫°nh b·∫±ng nhau."
        },
        {
            id: 27,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "H√¨nh ch·ªØ nh·∫≠t $\\text{ABCD}$ c√≥ $AB = 3 \\text{cm}$ v√† chu vi $14 \\text{cm}$. ƒê·ªô d√†i c·∫°nh $\\text{BC}$ l√† bao nhi√™u $\\text{cm}$?",
            options: [
                { text: "$4 \\text{ cm}$", correct: true, rationale: "N·ª≠a chu vi l√† $14:2 = 7 \\text{ cm}$. C·∫°nh $\\text{BC} = 7 - 3 = 4 \\text{ cm}$." },
                { text: "$3.5 \\text{ cm}$", correct: false, rationale: "T√≠nh to√°n l·∫°i." },
                { text: "$11 \\text{ cm}$", correct: false, rationale: "ƒê√¢y l√† n·ª≠a chu vi." },
                { text: "$5 \\text{ cm}$", correct: false, rationale: "T√≠nh to√°n l·∫°i." }
            ],
            answer: "$4 \\text{ cm}$",
            hint: "N·ª≠a chu vi h√¨nh ch·ªØ nh·∫≠t l√† t·ªïng c·ªßa chi·ªÅu d√†i v√† chi·ªÅu r·ªông."
        },
        {
            id: 28,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "S√¢n nh√† b√°c H√πng h√¨nh ch·ªØ nh·∫≠t d√†i $12 \\text{m}$, r·ªông $9 \\text{m}$. Di·ªán t√≠ch s√¢n l√† bao nhi√™u $\\text{m}^2$?",
            answer: "108",
            hint: "Di·ªán t√≠ch h√¨nh ch·ªØ nh·∫≠t b·∫±ng d√†i nh√¢n r·ªông."
        },
        {
            id: 29,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "M·ªôt l·ªëi ƒëi h√¨nh ch·ªØ nh·∫≠t c√≥ chi·ªÅu d√†i $12 \\text{m}$ v√† chi·ªÅu r·ªông $2 \\text{m}$. T·ªïng chi ph√≠ l√°t g·∫°ch (v·ªõi $100.000$ ƒë·ªìng$/\\text{m}^2$) l√† bao nhi√™u ƒë·ªìng?",
            options: [
                { text: "$2.400.000$ ƒë·ªìng", correct: true, rationale: "Di·ªán t√≠ch $= 12 \\cdot 2 = 24 \\text{ m}^2$. Chi ph√≠ $= 24 \\cdot 100.000 = 2.400.000$ ƒë·ªìng." },
                { text: "$1.200.000$ ƒë·ªìng", correct: false, rationale: "B·∫°n c√≥ th·ªÉ ƒë√£ t√≠nh sai di·ªán t√≠ch." },
                { text: "$24.000.000$ ƒë·ªìng", correct: false, rationale: "B·∫°n c√≥ th·ªÉ ƒë√£ nh√¢n sai." },
                { text: "$240.000$ ƒë·ªìng", correct: false, rationale: "B·∫°n c√≥ th·ªÉ ƒë√£ nh√¢n sai." }
            ],
            answer: "$2.400.000$ ƒë·ªìng",
            hint: "ƒê·∫ßu ti√™n, t√≠nh di·ªán t√≠ch l·ªëi ƒëi."
        },
        {
            id: 30,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "M·ªôt m·∫£nh v∆∞·ªùn h√¨nh vu√¥ng c·∫°nh $10 \\text{m}$ c√≥ l·ªëi ƒëi **xung quanh** r·ªông $2 \\text{m}$. ƒê·ªô d√†i c·∫°nh c·ªßa m·∫£nh v∆∞·ªùn tr·ªìng rau h√¨nh vu√¥ng b√™n trong l√† bao nhi√™u $\\text{m}$?",
            answer: "6",
            hint: "L·ªëi ƒëi xung quanh l√†m gi·∫£m $2 \\cdot 2 = 4 \\text{m}$ v√†o m·ªói chi·ªÅu c·ªßa m·∫£nh ƒë·∫•t."
        },
        {
            id: 31,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Chu vi c·ªßa h√¨nh b√¨nh h√†nh c√≥ ƒë·ªô d√†i hai c·∫°nh l√† $10 \\text{cm}$ v√† $14 \\text{cm}$ l√† bao nhi√™u $\\text{cm}$?",
            options: [
                { text: "$24 \\text{ cm}$", correct: false, rationale: "Chu vi b·∫±ng t·ªïng ƒë·ªô d√†i 4 c·∫°nh." },
                { text: "$48 \\text{ cm}$", correct: true, rationale: "Chu vi $= 2 \\cdot (10 + 14) = 48 \\text{ cm}$." },
                { text: "$140 \\text{ cm}$", correct: false, rationale: "ƒê√¢y l√† di·ªán t√≠ch (n·∫øu chi·ªÅu cao l√† 14)." },
                { text: "$28 \\text{ cm}$", correct: false, rationale: "Ch∆∞a t√≠nh c·∫°nh $10 \\text{ cm}$." }
            ],
            answer: "$48 \\text{ cm}$",
            hint: "C√¥ng th·ª©c chu vi h√¨nh b√¨nh h√†nh: $P = 2 \\cdot (a+b)$."
        },
        {
            id: 32,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "H√¨nh thoi c√≥ ƒë·ªô d√†i hai ƒë∆∞·ªùng ch√©o l√† $6 \\text{cm}$ v√† $8 \\text{cm}$. T√≠nh di·ªán t√≠ch h√¨nh thoi ƒë√≥ (ƒë∆°n v·ªã $\\text{cm}^2$).",
            answer: "24",
            hint: "C√¥ng th·ª©c di·ªán t√≠ch h√¨nh thoi: $S = \\frac{1}{2} \\cdot d_1 \\cdot d_2$."
        },
        {
            id: 33,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "M·∫£nh ƒë·∫•t h√¨nh ch·ªØ nh·∫≠t d√†i $12 \\text{m}$, r·ªông $10 \\text{m}$. Di·ªán t√≠ch khu v·ª±c tr·ªìng hoa h√¨nh b√¨nh h√†nh $\\text{AMCN}$ (c√≥ ƒë√°y $\\text{AM} = 6 \\text{m}$ v√† chi·ªÅu cao $\\text{AD} = 10 \\text{m}$) l√† bao nhi√™u $\\text{m}^2$?",
            options: [
                { text: "$120 \\text{ m}^2$", correct: false, rationale: "ƒê√¢y l√† di·ªán t√≠ch to√†n b·ªô m·∫£nh ƒë·∫•t." },
                { text: "$60 \\text{ m}^2$", correct: true, rationale: "Di·ªán t√≠ch $= \\text{AM} \\cdot \\text{AD} = 6 \\cdot 10 = 60 \\text{ m}^2$." },
                { text: "$30 \\text{ m}^2$", correct: false, rationale: "B·∫°n c√≥ th·ªÉ ƒë√£ chia $2$." },
                { text: "$22 \\text{ m}^2$", correct: false, rationale: "C·∫ßn l·∫•y ƒë√°y nh√¢n v·ªõi chi·ªÅu cao t∆∞∆°ng ·ª©ng." }
            ],
            answer: "$60 \\text{ m}^2$",
            hint: "Di·ªán t√≠ch h√¨nh b√¨nh h√†nh b·∫±ng ƒë√°y nh√¢n chi·ªÅu cao."
        },
        {
            id: 34,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "T·ªïng di·ªán t√≠ch tr·ªìng hoa v√† tr·ªìng c·ªè (tr√™n m·∫£nh ƒë·∫•t d√†i $12 \\text{m}$, r·ªông $10 \\text{m}$) l√† bao nhi√™u $\\text{m}^2$?",
            answer: "120",
            hint: "T·ªïng di·ªán t√≠ch b·∫±ng di·ªán t√≠ch m·∫£nh ƒë·∫•t h√¨nh ch·ªØ nh·∫≠t."
        },
        {
            id: 35,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "H√¨nh thang c√¢n c√≥ hai ƒë√°y $4 \\text{cm}$ v√† $10 \\text{cm}$, chi·ªÅu cao $4 \\text{cm}$. T√≠nh di·ªán t√≠ch h√¨nh thang (ƒë∆°n v·ªã $\\text{cm}^2$)?",
            options: [
                { text: "$14 \\text{ cm}^2$", correct: false, rationale: "√Åp d·ª•ng c√¥ng th·ª©c di·ªán t√≠ch h√¨nh thang." },
                { text: "$28 \\text{ cm}^2$", correct: true, rationale: "Di·ªán t√≠ch $= \\frac{(4+10) \\cdot 4}{2} = 28 \\text{ cm}^2$." },
                { text: "$56 \\text{ cm}^2$", correct: false, rationale: "B·∫°n c√≥ th·ªÉ ƒë√£ kh√¥ng chia $2$." },
                { text: "$18 \\text{ cm}^2$", correct: false, rationale: "T√≠nh to√°n l·∫°i." }
            ],
            answer: "$28 \\text{ cm}^2$",
            hint: "S·ª≠ d·ª•ng c√¥ng th·ª©c di·ªán t√≠ch h√¨nh thang."
        },
        {
            id: 36,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "ƒê·ªÉ l√°t s√¢n h√¨nh ch·ªØ nh·∫≠t $12 \\text{m} \\times 9 \\text{m}$ b·∫±ng g·∫°ch vu√¥ng c·∫°nh $0,6 \\text{m}$, c·∫ßn bao nhi√™u vi√™n g·∫°ch?",
            options: [
                { text: "250 vi√™n", correct: false, rationale: "T·ªïng di·ªán t√≠ch s√¢n $= 108 \\text{ m}^2$. Di·ªán t√≠ch g·∫°ch $= 0.36 \\text{ m}^2$." },
                { text: "300 vi√™n", correct: true, rationale: "S·ªë g·∫°ch $= \\frac{108}{0.36} = 300$ vi√™n." },
                { text: "180 vi√™n", correct: false, rationale: "T√≠nh to√°n l·∫°i." },
                { text: "350 vi√™n", correct: false, rationale: "T√≠nh to√°n l·∫°i." }
            ],
            answer: "300 vi√™n",
            hint: "S·ªë vi√™n g·∫°ch = Di·ªán t√≠ch s√¢n $\\text{ /}$ Di·ªán t√≠ch $1$ vi√™n g·∫°ch."
        },
        {
            id: 37,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "T√≠nh ƒë·ªô d√†i h√†ng r√†o xung quanh m·∫£nh v∆∞·ªùn tr·ªìng rau h√¨nh vu√¥ng c√≥ c·∫°nh $8 \\text{m}$, c√≥ c·ª≠a ra v√†o r·ªông $2 \\text{m}$ (ƒë∆°n v·ªã $\\text{m}$).",
            answer: "30",
            hint: "Chu vi h√†ng r√†o = Chu vi h√¨nh vu√¥ng - ƒë·ªô r·ªông c·ª≠a."
        },
        {
            id: 38,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "M·ªôt ƒëo·∫°n th·∫≥ng d√†i $198 \\text{mm}$ ƒë∆∞·ª£c c·∫Øt th√†nh 3 ƒëo·∫°n b·∫±ng nhau. H·ªèi ƒë·ªô d√†i m·ªói ƒëo·∫°n (t·ª©c l√† ƒë·ªô d√†i c·∫°nh c·ªßa tam gi√°c ƒë·ªÅu ƒë∆∞·ª£c t·∫°o ra t·ª´ 3 ƒëo·∫°n n√†y) l√† bao nhi√™u $\\text{mm}$?",
            options: [
                { text: "$66 \\text{ mm}$", correct: true, rationale: "ƒê·ªô d√†i c·∫°nh $= 198 : 3 = 66 \\text{ mm}$." },
                { text: "$33 \\text{ mm}$", correct: false, rationale: "B·∫°n c√≥ th·ªÉ ƒë√£ chia 6." },
                { text: "$198 \\text{ mm}$", correct: false, rationale: "ƒê√¢y l√† ƒë·ªô d√†i ·ªëng h√∫t ban ƒë·∫ßu." },
                { text: "$54 \\text{ mm}$", correct: false, rationale: "T√≠nh to√°n l·∫°i." }
            ],
            answer: "$66 \\text{ mm}$",
            hint: "L·∫•y ƒë·ªô d√†i ƒëo·∫°n th·∫≥ng chia cho s·ªë ƒëo·∫°n c·∫Øt ra."
        },
        {
            id: 39,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "Chi ph√≠ tr·ªìng hoa (di·ªán t√≠ch $60 \\text{ m}^2$) v·ªõi gi√° $50.000$ ƒë·ªìng$/\\text{m}^2$ l√† bao nhi√™u ƒë·ªìng?",
            answer: "3000000",
            hint: "Chi ph√≠ $=$ Di·ªán t√≠ch $\\cdot$ ƒê∆°n gi√°."
        },
        {
            id: 40,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "Tr√™n m·∫£nh ƒë·∫•t $12 \\text{m} \\times 10 \\text{m}$ (di·ªán t√≠ch $120 \\text{ m}^2$), di·ªán t√≠ch tr·ªìng hoa l√† $60 \\text{ m}^2$. T√≠nh di·ªán t√≠ch tr·ªìng c·ªè (ƒë∆°n v·ªã $\\text{m}^2$).",
            answer: "60",
            hint: "Di·ªán t√≠ch c·ªè $=$ T·ªïng di·ªán t√≠ch $-$ Di·ªán t√≠ch hoa."
        },

        // --------------------------------------------------------------------------------
        // CH∆Ø∆†NG 4: TH·ªêNG K√ä (10 c√¢u) - ƒê√É S·ª¨A D·ªÆ LI·ªÜU B·ªä M·∫§T
        // --------------------------------------------------------------------------------
        {
            id: 41,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "Th·ªùi gian l√†m b√†i t·∫≠p To√°n (ph√∫t) c·ªßa 20 HS l·ªõp 6A l√†: $10, 5, 8, 8, 9, 7, 8, 9, 14, 8, 5, 7, 8, 10, 9, 8, 10, 7, 14, 8$. C√≥ bao nhi√™u b·∫°n l√†m b√†i trong th·ªùi gian ng·∫Øn nh·∫•t?",
            options: [
                { text: "1 b·∫°n", correct: false, rationale: "Th·ªùi gian ng·∫Øn nh·∫•t l√† $5$ ph√∫t." },
                { text: "2 b·∫°n", correct: true, rationale: "Th·ªùi gian ng·∫Øn nh·∫•t l√† $5$ ph√∫t, xu·∫•t hi·ªán $2$ l·∫ßn." },
                { text: "3 b·∫°n", correct: false, rationale: "Ki·ªÉm tra l·∫°i s·ªë l·∫ßn xu·∫•t hi·ªán c·ªßa th·ªùi gian ng·∫Øn nh·∫•t." },
                { text: "4 b·∫°n", correct: false, rationale: "Th·ªùi gian $7$ ph√∫t c√≥ $4$ l·∫ßn xu·∫•t hi·ªán, nh∆∞ng $5$ ph√∫t m·ªõi l√† ng·∫Øn nh·∫•t." }
            ],
            answer: "2 b·∫°n",
            hint: "T√¨m gi√° tr·ªã nh·ªè nh·∫•t trong d√£y s·ªë li·ªáu v√† ƒë·∫øm t·∫ßn s·ªë c·ªßa n√≥."
        },
        {
            id: 42,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "B·∫£ng ƒëi·ªÉm ki·ªÉm tra T·ªï 1 g·ªìm c√°c ƒëi·ªÉm: $7, 8, 7, 10, 6, 5, 9, 10, 4, 8$. ƒêi·ªÉm cao nh·∫•t m√† c√°c b·∫°n ƒë·∫°t ƒë∆∞·ª£c l√† bao nhi√™u?",
            options: [
                { text: "9", correct: false, rationale: "C√≥ ƒëi·ªÉm $10$." },
                { text: "10", correct: true, rationale: "ƒêi·ªÉm cao nh·∫•t l√† $10$, xu·∫•t hi·ªán $2$ l·∫ßn." },
                { text: "4", correct: false, rationale: "ƒê√¢y l√† ƒëi·ªÉm th·∫•p nh·∫•t." },
                { text: "8", correct: false, rationale: "Kh√¥ng ph·∫£i cao nh·∫•t." }
            ],
            answer: "10",
            hint: "Xem gi√° tr·ªã l·ªõn nh·∫•t trong d√£y ƒëi·ªÉm."
        },
        {
            id: 43,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "B·∫£ng ƒëi·ªÉm ki·ªÉm tra T·ªï 1 g·ªìm c√°c ƒëi·ªÉm: $7, 8, 7, 10, 6, 5, 9, 10, 4, 8$. S·ªë h·ªçc sinh c√≥ ƒëi·ªÉm d∆∞·ªõi $7$ l√† bao nhi√™u?",
            options: [
                { text: "1", correct: false, rationale: "ƒêi·ªÉm d∆∞·ªõi $7$ l√† $4, 5, 6$." },
                { text: "2", correct: false, rationale: "ƒêi·ªÉm d∆∞·ªõi $7$ l√† $4$ (L·ªôc), $5$ (H√πng), $6$ (Hi·∫øu)." },
                { text: "3", correct: true, rationale: "C√≥ $3$ h·ªçc sinh ƒë·∫°t ƒëi·ªÉm d∆∞·ªõi $7$ ($4, 5, 6$)." },
                { text: "4", correct: false, rationale: "Sai s·ªë l∆∞·ª£ng." }
            ],
            answer: "3",
            hint: "Li·ªát k√™ v√† ƒë·∫øm c√°c ƒëi·ªÉm $6, 5, 4$."
        },
        {
            id: 44,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "S·ªë h·ªçc vi√™n CLB Ti·∫øng Nh·∫≠t c√°c nƒÉm l√†: $2017: 30; 2018: 40; 2019: 50; 2020: 60$. NƒÉm $2020$ nhi·ªÅu h∆°n nƒÉm $2017$ bao nhi√™u h·ªçc vi√™n?",
            options: [
                { text: "10 h·ªçc vi√™n", correct: false, rationale: "ƒê√¢y l√† ch√™nh l·ªách gi·ªØa c√°c nƒÉm li√™n ti·∫øp." },
                { text: "20 h·ªçc vi√™n", correct: false, rationale: "T√≠nh to√°n l·∫°i." },
                { text: "30 h·ªçc vi√™n", correct: true, rationale: "Ch√™nh l·ªách $= 60 - 30 = 30$ h·ªçc vi√™n. ƒê√£ s·ª≠a l·ªói ƒë√°p √°n." },
                { text: "40 h·ªçc vi√™n", correct: false, rationale: "Ch√™nh l·ªách $= 60 - 30$." }
            ],
            answer: "30 h·ªçc vi√™n",
            hint: "Th·ª±c hi·ªán ph√©p tr·ª´: S·ªë h·ªçc vi√™n nƒÉm $2020$ tr·ª´ ƒëi nƒÉm $2017$."
        },
        {
            id: 45,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "D·ªØ li·ªáu ƒëi·ªÉm 10 m√¥n To√°n theo ng√†y l√†: Th·ª© Hai: $2$, Th·ª© Ba: $3$, Th·ª© T∆∞: $5$, Th·ª© NƒÉm: $4$, Th·ª© S√°u: $2$. Ng√†y n√†o c√≥ s·ªë h·ªçc sinh ƒë·∫°t ƒëi·ªÉm $10$ nhi·ªÅu nh·∫•t?",
            options: [
                { text: "Th·ª© Hai", correct: false, rationale: "Ch·ªâ c√≥ $2$ ƒëi·ªÉm $10$." },
                { text: "Th·ª© T∆∞", correct: true, rationale: "C√≥ $5$ ƒëi·ªÉm $10$, l√† s·ªë l∆∞·ª£ng l·ªõn nh·∫•t." },
                { text: "Th·ª© NƒÉm", correct: false, rationale: "C√≥ $4$ ƒëi·ªÉm $10$." },
                { text: "Th·ª© S√°u", correct: false, rationale: "Ch·ªâ c√≥ $2$ ƒëi·ªÉm $10$." }
            ],
            answer: "Th·ª© T∆∞",
            hint: "T√¨m ng√†y c√≥ s·ªë l∆∞·ª£ng ƒëi·ªÉm $10$ l·ªõn nh·∫•t."
        },
        {
            id: 46,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "D·ªØ li·ªáu ƒëi·ªÉm 10 m√¥n To√°n theo ng√†y l√†: Th·ª© Hai: $2$, Th·ª© Ba: $3$, Th·ª© T∆∞: $5$, Th·ª© NƒÉm: $4$, Th·ª© S√°u: $2$. T·ªïng s·ªë h·ªçc sinh ƒë·∫°t ƒëi·ªÉm $10$ trong tu·∫ßn l√† bao nhi√™u?",
            options: [
                { text: "14", correct: false, rationale: "T·ªïng s·ªë $= 2 + 3 + 5 + 4 + 2$." },
                { text: "15", correct: false, rationale: "T·ªïng s·ªë $= 2 + 3 + 5 + 4 + 2$." },
                { text: "16", correct: true, rationale: "T·ªïng s·ªë $= 2 + 3 + 5 + 4 + 2 = 16$ h·ªçc sinh." },
                { text: "18", correct: false, rationale: "T·ªïng s·ªë $= 2 + 3 + 5 + 4 + 2$." }
            ],
            answer: "16",
            hint: "C·ªông s·ªë ƒëi·ªÉm $10$ c·ªßa c√°c ng√†y trong tu·∫ßn l·∫°i."
        },
        {
            id: 47,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "D·ªØ li·ªáu ƒëi·ªÉm 10 m√¥n To√°n theo ng√†y l√†: Th·ª© Hai: $2$, Th·ª© Ba: $3$, Th·ª© T∆∞: $5$, Th·ª© NƒÉm: $4$, Th·ª© S√°u: $2$. Ng√†y n√†o c√≥ s·ªë h·ªçc sinh ƒë·∫°t ƒëi·ªÉm $10$ b·∫±ng nhau?",
            options: [
                { text: "Th·ª© Hai v√† Th·ª© T∆∞", correct: false, rationale: "Th·ª© Hai c√≥ $2$, Th·ª© T∆∞ c√≥ $5$." },
                { text: "Th·ª© Ba v√† Th·ª© NƒÉm", correct: false, rationale: "Th·ª© Ba c√≥ $3$, Th·ª© NƒÉm c√≥ $4$." },
                { text: "Th·ª© T∆∞ v√† Th·ª© NƒÉm", correct: false, rationale: "Th·ª© T∆∞ c√≥ $5$, Th·ª© NƒÉm c√≥ $4$." },
                { text: "Th·ª© Hai v√† Th·ª© S√°u", correct: true, rationale: "C·∫£ hai ng√†y ƒë·ªÅu c√≥ $2$ ƒëi·ªÉm $10$." }
            ],
            answer: "Th·ª© Hai v√† Th·ª© S√°u",
            hint: "T√¨m c√°c ng√†y c√≥ c√πng gi√° tr·ªã ƒëi·ªÉm $10$."
        },
        {
            id: 48,
            type: 'TNC',
            time: 30, // TƒÇNG L√äN 30s
            question: "T·ªïng s·ªë h·ªçc sinh trong T·ªï 1 l√† bao nhi√™u d·ª±a tr√™n b·∫£ng ƒëi·ªÉm (g·ªìm 10 ƒëi·ªÉm s·ªë: $7, 8, 7, 10, 6, 5, 9, 10, 4, 8$)?",
            options: [
                { text: "7", correct: false, rationale: "$7$ l√† m·ªôt trong c√°c ƒëi·ªÉm s·ªë." },
                { text: "8", correct: false, rationale: "$8$ l√† m·ªôt trong c√°c ƒëi·ªÉm s·ªë." },
                { text: "10", correct: true, rationale: "C√≥ $10$ ƒëi·ªÉm s·ªë t∆∞∆°ng ·ª©ng v·ªõi $10$ h·ªçc sinh trong t·ªï." },
                { text: "108", correct: false, rationale: "ƒê√¢y l√† t·ªïng c√°c ƒëi·ªÉm s·ªë." }
            ],
            answer: "10",
            hint: "ƒê·∫øm s·ªë l∆∞·ª£ng h·ªçc sinh ƒë∆∞·ª£c li·ªát k√™ trong b·∫£ng."
        },
        {
            id: 49,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "T·ªïng s·ªë h·ªçc vi√™n CLB Ti·∫øng Nh·∫≠t trong $4$ nƒÉm ($2017: 30; 2018: 40; 2019: 50; 2020: 60$) l√† bao nhi√™u?",
            answer: "180",
            hint: "Th·ª±c hi·ªán ph√©p c·ªông: $30 + 40 + 50 + 60$."
        },
        {
            id: 50,
            type: 'TLN',
            time: 180, // TƒÇNG L√äN 3 PH√öT (180s)
            question: "M·ª©c nhi·ªát ƒë·ªô $-8^{\\circ}C$ cao h∆°n $-12^{\\circ}C$ bao nhi√™u ƒë·ªô?",
            answer: "4",
            hint: "Th·ª±c hi·ªán ph√©p tr·ª´: $-8 - (-12)$."
        }
    ];

    // --- Game State Variables ---
    let currentQuestionIndex = 0;
    let timerInterval = null;
    let restInterval = null;
    let score = 0;
    let userName = "";
    let userClass = "";
    let isGameRunning = false;

    // --- Utility Functions ---
    function getElement(id) {
        return document.getElementById(id);
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function startTimer(duration, elementId, onTimeout) {
        let timer = duration;
        getElement(elementId).textContent = timer;
        timerInterval = setInterval(() => {
            timer--;
            getElement(elementId).textContent = timer;
            if (timer <= 0) {
                clearInterval(timerInterval);
                onTimeout();
            }
        }, 1000);
    }

    function showFeedback(isCorrect) {
        const feedbackEl = getElement('feedback-message');
        const feedbackIconEl = getElement('feedback-icon');
        const overlay = getElement('overlay');
        const currentQ = QUIZ_QUESTIONS[currentQuestionIndex];
        
        let correctAnswerText = currentQ.answer;
        if (currentQ.type === 'TNC') {
            const correctOption = currentQ.options.find(opt => opt.correct);
            if (correctOption) {
                correctAnswerText = correctOption.text;
            }
        }


        if (isCorrect) {
            score++;
            generateAndPlayAudio('correct');
            feedbackIconEl.innerHTML = '<span class="text-6xl animate-bounce">üéâ</span>';
            feedbackEl.innerHTML = `CH√çNH X√ÅC! (+1 ƒëi·ªÉm)`;
        } else {
            generateAndPlayAudio('wrong');
            feedbackIconEl.innerHTML = '<span class="text-6xl text-red-600 font-bold">‚ùå</span>';
            feedbackEl.innerHTML = `CH∆ØA ƒê√öNG!`;
            
            // L∆ØU √ù: ƒê√É X√ìA D√íNG HI·ªÇN TH·ªä ƒê√ÅP √ÅN ƒê√öNG KHI SAI
            // feedbackEl.innerHTML += `<br><span class="text-base text-red-600 font-semibold">ƒê√°p √°n ƒë√∫ng: ${correctAnswerText}</span>`;
        }

        getElement('current-score').textContent = score;
        overlay.classList.remove('hidden');

        // B·∫Øt ƒë·∫ßu th·ªùi gian ngh·ªâ 3s
        let restTime = 3;
        
        // C·∫≠p nh·∫≠t: Ch·ªâ c·∫ßn hi·ªÉn th·ªã feedback v√† ƒë·∫øm ng∆∞·ª£c th·ªùi gian ngh·ªâ
        feedbackEl.innerHTML += `<br><span class="text-lg mt-2 block">C√¢u h·ªèi ti·∫øp theo sau ${restTime}s...</span>`;
        restInterval = setInterval(() => {
            restTime--;
            
            // L·∫•y l·∫°i ph·∫ßn ph·∫£n h·ªìi (ƒë√∫ng/sai) 
            let currentFeedback = feedbackEl.innerHTML.split('<br>')[0];
            
            feedbackEl.innerHTML = currentFeedback + 
                                   `<br><span class="text-lg mt-2 block">C√¢u h·ªèi ti·∫øp theo sau ${restTime}s...</span>`;

            if (restTime <= 0) {
                clearInterval(restInterval);
                overlay.classList.add('hidden');
                nextQuestion();
            }
        }, 1000);
    }

    function showHint() {
        const currentQ = QUIZ_QUESTIONS[currentQuestionIndex];
        const hintEl = getElement('hint-text');
        hintEl.classList.remove('hidden');
        hintEl.textContent = `G·ª£i √Ω: ${currentQ.hint}`;
    }

    // --- Game Logic ---
    function startQuiz() {
        const nameInput = getElement('name-input').value.trim();
        const classInput = getElement('class-input').value.trim();

        if (nameInput === "" || classInput === "") {
            alert("Vui l√≤ng nh·∫≠p T√™n v√† L·ªõp ƒë·ªÉ b·∫Øt ƒë·∫ßu!");
            return;
        }

        userName = nameInput;
        userClass = classInput;
        isGameRunning = true;
        score = 0;
        currentQuestionIndex = -1; // B·∫Øt ƒë·∫ßu t·ª´ -1 ƒë·ªÉ nextQuestion() chuy·ªÉn ƒë·∫øn 0

        getElement('start-screen').classList.add('hidden');
        getElement('quiz-screen').classList.remove('hidden');
        getElement('user-info-display').textContent = `Th√≠ sinh: ${userName} - L·ªõp: ${userClass}`;
        getElement('current-score').textContent = score;

        nextQuestion();
    }

    function nextQuestion() {
        currentQuestionIndex++;
        clearInterval(timerInterval);
        clearInterval(restInterval);
        getElement('hint-text').classList.add('hidden');
        getElement('hint-text').textContent = '';
        isGameRunning = true; // C·∫≠p nh·∫≠t: Lu√¥n cho ph√©p game ch·∫°y tr∆∞·ªõc khi render

        if (currentQuestionIndex >= QUIZ_QUESTIONS.length) {
            showResults();
            return;
        }

        const currentQ = QUIZ_QUESTIONS[currentQuestionIndex];
        renderQuestion(currentQ);
        const duration = currentQ.time;

        startTimer(duration, 'timer', () => {
            // H·∫øt gi·ªù
            checkAnswer(null);
        });
    }

    function renderQuestion(q) {
        getElement('question-counter').textContent = `C√¢u ${currentQuestionIndex + 1}/${QUIZ_QUESTIONS.length}`;
        getElement('question-type').textContent = q.type === 'TNC' ? 'TR·∫ÆC NGHI·ªÜM' : 'TR·∫¢ L·ªúI NG·∫ÆN';
        
        // C·∫≠p nh·∫≠t: KH√îNG lo·∫°i b·ªè d·∫•u ƒë√¥ la, ƒë·ªÉ MathJax t·ª± render c√¥ng th·ª©c
        getElement('question-text').innerHTML = q.question; 
        
        getElement('timer-duration').textContent = q.time + 's';
        getElement('question-container').dataset.type = q.type;

        const optionsContainer = getElement('options-container');
        optionsContainer.innerHTML = '';
        getElement('short-answer-container').classList.add('hidden');

        const elementsToTypeset = [getElement('question-text')]; // Th√™m c√¢u h·ªèi v√†o danh s√°ch

        if (q.type === 'TNC') {
            optionsContainer.classList.remove('hidden');
            // X√°o tr·ªôn ƒë√°p √°n
            const shuffledOptions = shuffleArray([...q.options]);

            shuffledOptions.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'w-full text-left p-3 my-2 bg-white text-gray-800 rounded-lg shadow-md hover:bg-yellow-100 transition duration-150 border border-gray-300 mathjax-option';
                button.innerHTML = `<span class="font-bold mr-2">${String.fromCharCode(65 + index)}.</span> ${option.text}`;
                button.onclick = () => checkAnswer(option.correct ? option.text : option.text); // G·ª≠i n·ªôi dung text ƒë·ªÉ ki·ªÉm tra
                optionsContainer.appendChild(button);
                elementsToTypeset.push(button); // Th√™m c√°c n√∫t ƒë√°p √°n v√†o danh s√°ch
            });
            getElement('submit-btn').classList.add('hidden');
        } else {
            optionsContainer.classList.add('hidden');
            getElement('short-answer-container').classList.remove('hidden');
            getElement('short-answer-input').value = '';
            getElement('submit-btn').classList.remove('hidden');
            
            // C·∫≠p nh·∫≠t quan tr·ªçng: G√°n l·∫°i s·ª± ki·ªán click cho n√∫t G·ª¨I TR·∫¢ L·ªúI
            getElement('submit-btn').onclick = () => {
                // Th√™m ki·ªÉm tra n·∫øu tr√≤ ch∆°i ƒëang ngh·ªâ gi·ªØa c√¢u h·ªèi th√¨ kh√¥ng cho submit
                if (!isGameRunning) return; 
                
                const userAnswer = getElement('short-answer-input').value.trim();
                checkAnswer(userAnswer);
            };
        }

        // C·∫≠p nh·∫≠t: K√≠ch ho·∫°t MathJax ƒë·ªÉ hi·ªÉn th·ªã c√¥ng th·ª©c sau khi n·ªôi dung ƒë∆∞·ª£c t·∫£i
        if (window.MathJax) {
            // S·ª≠ d·ª•ng MathJax.typesetPromise v√† truy·ªÅn danh s√°ch c√°c ph·∫ßn t·ª≠ c·∫ßn render
            MathJax.typesetPromise(elementsToTypeset).catch((err) => console.error("MathJax typesetting error:", err));
        }
    }

    function checkAnswer(userAnswer) {
        // C·∫≠p nh·∫≠t: Ki·ªÉm tra n·∫øu isGameRunning l√† false th√¨ tho√°t ngay l·∫≠p t·ª©c
        if (!isGameRunning) return; 
        
        // C·∫≠p nh·∫≠t: Ngay khi nh·∫≠n c√¢u tr·∫£ l·ªùi, l·∫≠p t·ª©c d·ª´ng game ƒë·ªÉ x·ª≠ l√Ω
        isGameRunning = false; 
        clearInterval(timerInterval);

        const currentQ = QUIZ_QUESTIONS[currentQuestionIndex];
        let isCorrect = false;

        if (userAnswer === null) { // H·∫øt gi·ªù
            showFeedback(false);
            return;
        }

        if (currentQ.type === 'TNC') {
            const selectedOption = currentQ.options.find(opt => opt.text === userAnswer);
            isCorrect = selectedOption && selectedOption.correct;
        } else { // TLN
            // So s√°nh c√¢u tr·∫£ l·ªùi ng·∫Øn, kh√¥ng ph√¢n bi·ªát ch·ªØ hoa/th∆∞·ªùng v√† kho·∫£ng tr·∫Øng th·ª´a
            const normalizedUserAnswer = userAnswer.toLowerCase().replace(/[^a-z0-9]/g, '');
            const normalizedCorrectAnswer = currentQ.answer.toLowerCase().replace(/[^a-z0-9]/g, '');

            if (currentQ.id === 6 || currentQ.id === 7 || currentQ.id === 9 || currentQ.id === 16 || currentQ.id === 18 || currentQ.id === 23 || currentQ.id === 26 || currentQ.id === 28 || currentQ.id === 30 || currentQ.id === 32 || currentQ.id === 34 || currentQ.id === 37 || currentQ.id === 39 || currentQ.id === 40 || currentQ.id === 49 || currentQ.id === 50) {
                 // Cho c√°c c√¢u tr·∫£ l·ªùi ng·∫Øn l√† s·ªë, ch·ªâ so s√°nh gi√° tr·ªã s·ªë
                isCorrect = parseFloat(userAnswer) === parseFloat(currentQ.answer);
            } else {
                // Cho c√°c c√¢u tr·∫£ l·ªùi ng·∫Øn l√† vƒÉn b·∫£n/bi·ªÉu th·ª©c, so s√°nh chu·ªói ƒë√£ chu·∫©n h√≥a
                 isCorrect = normalizedUserAnswer === normalizedCorrectAnswer;
            }
        }

        showFeedback(isCorrect);
        // Sau khi showFeedback, isGameRunning s·∫Ω ƒë∆∞·ª£c thi·∫øt l·∫≠p l·∫°i l√† true khi chuy·ªÉn sang c√¢u ti·∫øp theo (ho·∫∑c h·∫øt gi·ªù ngh·ªâ)
    }

    function showResults() {
        clearInterval(timerInterval);
        getElement('quiz-screen').classList.add('hidden');
        getElement('results-screen').classList.remove('hidden');

        const totalQuestions = QUIZ_QUESTIONS.length;
        const finalScore = score;
        const percentage = ((finalScore / totalQuestions) * 100).toFixed(1);

        getElement('final-name').textContent = userName;
        getElement('final-class').textContent = userClass;
        getElement('final-score').textContent = finalScore;
        getElement('total-questions').textContent = totalQuestions;
        getElement('score-percentage').textContent = percentage + '%';

        let rankMessage = "";
        if (percentage >= 90) {
            rankMessage = "Xu·∫•t s·∫Øc! B·∫°n n·∫Øm v·ªØng ki·∫øn th·ª©c r·∫•t t·ªët. üéâ";
        } else if (percentage >= 70) {
            rankMessage = "Gi·ªèi! C·ªë g·∫Øng luy·ªán t·∫≠p th√™m ·ªü c√°c c√¢u sai nh√©. üëç";
        } else if (percentage >= 50) {
            rankMessage = "Kh√°! B·∫°n c·∫ßn √¥n l·∫°i c√°c ph·∫ßn c√≤n y·∫øu.";
        } else {
            rankMessage = "C·∫ßn tƒÉng c∆∞·ªùng √¥n t·∫≠p ƒë·ªÉ ƒë·∫°t k·∫øt qu·∫£ t·ªët h∆°n.";
        }
        getElement('rank-message').textContent = rankMessage;
    }

    // T·∫£i MathJax (ƒë∆∞·ª£c g·ªçi sau khi c·∫•u h√¨nh)
    function loadMathJaxScript() {
        const script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
        script.async = true;
        document.head.appendChild(script);
    }

    function startInitialSetup() {
        // X√°o tr·ªôn th·ª© t·ª± c√¢u h·ªèi khi t·∫£i trang
        shuffleArray(QUIZ_QUESTIONS);
    }
    
    // B·∫Øt ƒë·∫ßu t·∫£i MathJax
    loadMathJaxScript();

</script>

<div class="min-h-screen bg-gray-100 flex items-center justify-center font-sans">

    <!-- Start Screen -->
    <div id="start-screen" class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md">
        <h1 class="text-3xl font-extrabold text-blue-600 mb-4 text-center">TR√í CH∆†I √îN T·∫¨P TO√ÅN 6</h1>
        <p class="text-center text-gray-600 mb-6">S·∫µn s√†ng th·ª≠ th√°ch v·ªõi 50 c√¢u h·ªèi t·ª´ ƒë·ªÅ c∆∞∆°ng?</p>

        <div class="mb-4">
            <label for="name-input" class="block text-sm font-medium text-gray-700">T√™n c·ªßa b·∫°n:</label>
            <input type="text" id="name-input" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Nguy·ªÖn VƒÉn A">
        </div>

        <div class="mb-6">
            <label for="class-input" class="block text-sm font-medium text-gray-700">L·ªõp:</label>
            <input type="text" id="class-input" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="6A1">
        </div>

        <button onclick="startQuiz()" class="w-full bg-green-500 text-white py-3 rounded-lg font-semibold text-lg hover:bg-green-600 transition duration-150 shadow-lg transform hover:scale-105">
            B·∫ÆT ƒê·∫¶U KI·ªÇM TRA
        </button>
    </div>

    <!-- Quiz Screen -->
    <div id="quiz-screen" class="hidden w-full max-w-3xl">
        <div class="bg-white p-6 rounded-xl shadow-2xl">
            <!-- Header/Info -->
            <div class="flex justify-between items-center mb-4 pb-3 border-b border-gray-200">
                <div class="text-sm font-medium text-gray-600" id="user-info-display"></div>
                <div class="flex items-center space-x-4">
                    <span class="text-lg font-bold text-gray-800">ƒêi·ªÉm: <span id="current-score" class="text-blue-600">0</span></span>
                    <span class="text-lg font-bold text-gray-800" id="question-counter">C√¢u 1/50</span>
                </div>
            </div>

            <!-- Timer & Type -->
            <div class="flex justify-between items-center mb-6">
                <span id="question-type" class="px-3 py-1 bg-purple-100 text-purple-800 text-sm font-semibold rounded-full">TR·∫ÆC NGHI·ªÜM</span>
                <div class="flex items-center space-x-2 bg-red-500 text-white px-4 py-2 rounded-full shadow-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l3 3a1 1 0 001.414-1.414L11 9.586V6z" clip-rule="evenodd" />
                    </svg>
                    <span class="font-bold">Th·ªùi gian: <span id="timer">15</span>s</span>
                    <span id="timer-duration" class="hidden"></span>
                </div>
            </div>

            <!-- Question -->
            <div id="question-container" class="mb-8">
                <p id="question-text" class="text-xl font-semibold text-gray-900 mb-4"></p>
                <div id="options-container" class="space-y-3">
                    <!-- Options will be rendered here -->
                </div>
                <!-- Short Answer Input -->
                <div id="short-answer-container" class="hidden">
                    <input type="text" id="short-answer-input" class="mt-1 block w-full px-4 py-3 border-2 border-blue-300 rounded-lg shadow-inner focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-lg" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n">
                </div>
                <button id="submit-btn" class="hidden mt-4 w-full bg-blue-500 text-white py-3 rounded-lg font-semibold text-lg hover:bg-blue-600 transition duration-150">
                    G·ª¨I TR·∫¢ L·ªúI
                </button>
            </div>

            <!-- Hint -->
            <p id="hint-text" class="hidden text-sm text-yellow-700 bg-yellow-50 p-3 rounded-lg border-l-4 border-yellow-400 cursor-pointer" onclick="showHint()"></p>
             <button onclick="showHint()" class="mt-4 text-blue-500 hover:text-blue-700 font-medium text-sm">
                [G·ª£i √Ω]
            </button>
        </div>
    </div>

    <!-- Overlay Feedback -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-70 z-50 hidden flex items-center justify-center">
        <div class="bg-white p-8 rounded-xl shadow-2xl text-center">
            <div id="feedback-icon" class="mb-4"></div>
            <p id="feedback-message" class="text-2xl font-bold text-gray-800"></p>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="results-screen" class="hidden w-full max-w-md">
        <div class="bg-white p-8 rounded-xl shadow-2xl text-center">
            <h2 class="text-3xl font-extrabold text-green-600 mb-4">K·∫æT QU·∫¢ KI·ªÇM TRA</h2>
            <div class="mb-6 space-y-2">
                <p class="text-lg">Th√≠ sinh: <span id="final-name" class="font-bold text-gray-800"></span></p>
                <p class="text-lg">L·ªõp: <span id="final-class" class="font-bold text-gray-800"></span></p>
            </div>

            <div class="bg-blue-50 p-6 rounded-lg mb-6">
                <p class="text-xl font-medium text-gray-700">ƒêi·ªÉm s·ªë cu·ªëi c√πng:</p>
                <p class="text-5xl font-extrabold text-blue-600 my-2">
                    <span id="final-score">0</span> / <span id="total-questions">50</span>
                </p>
                <p class="text-xl font-medium text-gray-700">T·ª∑ l·ªá ch√≠nh x√°c: <span id="score-percentage" class="text-blue-600 font-extrabold">0%</span></p>
            </div>

            <p id="rank-message" class="text-lg font-semibold text-gray-800 mb-6"></p>

            <button onclick="window.location.reload()" class="w-full bg-red-500 text-white py-3 rounded-lg font-semibold text-lg hover:bg-red-600 transition duration-150 shadow-lg">
                TH·ª¨ L·∫†I
            </button>
        </div>
    </div>
</div>